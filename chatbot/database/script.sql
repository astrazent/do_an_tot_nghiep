DROP TABLE IF EXISTS Messages; DROP TABLE IF EXISTS Conversations; DROP TABLE IF EXISTS DocumentChunks; DROP TABLE IF EXISTS Documents; DROP TABLE IF EXISTS DataSources;   CREATE TABLE     DataSources (     id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,     name VARCHAR(255) NOT NULL,     slug VARCHAR(150) NOT NULL UNIQUE,     description TEXT,     is_active BOOLEAN DEFAULT TRUE,     created_at DATETIME DEFAULT CURRENT_TIMESTAMP,     updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;    CREATE TABLE     Documents (     id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,     file_name VARCHAR(150),     datasource_id INT UNSIGNED NULL,     description VARCHAR(250) NOT NULL,     source_type ENUM('pdf','json','txt') NOT NULL,     doc_owner ENUM('user','system') NOT NULL DEFAULT 'user',     is_active BOOLEAN DEFAULT TRUE,     created_at DATETIME DEFAULT CURRENT_TIMESTAMP,     updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,     CONSTRAINT fk_docs_datasource         FOREIGN KEY (datasource_id) REFERENCES DataSources(id)         ON DELETE SET NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;   CREATE TABLE     DocumentChunks (     id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,     document_id INT UNSIGNED NOT NULL,     chunk_index INT NOT NULL,     content TEXT NOT NULL,     token_count INT DEFAULT 0,     created_at DATETIME DEFAULT CURRENT_TIMESTAMP,      CONSTRAINT fk_chunks_docs FOREIGN KEY (document_id)         REFERENCES Documents(id) ON DELETE CASCADE );   CREATE TABLE     Conversations (     id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,     user_id INT UNSIGNED NOT NULL,     title VARCHAR(255) NOT NULL,     status ENUM('active','ended') NOT NULL DEFAULT 'active',     start_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,     last_message_time DATETIME NULL,     end_time DATETIME NULL );   CREATE TABLE     Messages (     id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,     conversation_id INT UNSIGNED NOT NULL,     sender VARCHAR(50) NOT NULL,     content TEXT NOT NULL,     created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,     CONSTRAINT fk_messages_conversation         FOREIGN KEY (conversation_id) REFERENCES Conversations(id)         ON DELETE CASCADE );   INSERT INTO DataSources (name, slug, description) VALUES ('Thông tin doanh nghiệp', 'business-info', 'Chứa toàn bộ nội dung liên quan đến thông tin doanh nghiệp, bao gồm: tuyển đại lý, liên hệ, địa chỉ,...'), ('Thông tin mua hàng', 'purchase-info', 'Chứa toàn bộ nội dung liên quan đến thông tin đơn hàng, bao gồm: sản phẩm, thể loại, phương thức thanh toán,...');   INSERT INTO Documents (file_name, datasource_id, description, source_type, is_active, doc_owner) VALUES ('tuyen_dai_ly.txt', 1, 'Chính sách tuyển đại lý', 'txt', TRUE, 'user'), ('gioi_thieu.pdf', 1, 'Giới thiệu doanh nghiệp', 'pdf', TRUE, 'user'), ('lien_he.txt', 1, 'Thông tin liên hệ', 'txt', TRUE, 'user'), ('shipments.json', 2, 'Danh sách các phương thức vận chuyển', 'json', TRUE, 'system'), ('payments.json', 2, 'Danh sách các phương thức thanh toán', 'json', TRUE, 'system'), ('products.json', 2, 'Danh sách thông tin sản phẩm', 'json', TRUE, 'system');   INSERT INTO Conversations (user_id, title, status, start_time, last_message_time, end_time) VALUES (11, 'Tư vấn thực đơn hôm nay', 'active', NOW(), NULL, NULL), (11, 'Tra cứu lịch giao hàng', 'ended', '2025-11-25 10:00:00', '2025-11-25 10:15:00', '2025-11-25 10:15:00'), (11, 'Hỏi về nguồn gốc nguyên liệu', 'active', NOW(), NULL, NULL), (11, 'Đặt món trực tuyến', 'ended', '2025-11-20 14:30:00', '2025-11-20 14:50:00', '2025-11-20 14:50:00');   INSERT INTO Messages (conversation_id, sender, content, created_at) VALUES  (1, 'user', 'Xin chào, tôi muốn hỏi về thực đơn hôm nay.', NOW()), (1, 'bot', 'Chào bạn! Hôm nay chúng tôi có đặc sản gà nướng Hòa Bình, cá kho Hà Nội và salad trộn.', NOW()), (1, 'user', 'Tôi muốn gọi món gà nướng và salad.', NOW()), (1, 'bot', 'Bạn có muốn thêm nước uống kèm không?', NOW()),   (2, 'user', 'Cho tôi biết lịch giao hàng tuần này.', '2025-11-25 10:05:00'), (2, 'bot', 'Tuần này đơn hàng sẽ được giao vào Thứ 2, Thứ 4 và Thứ 6.', '2025-11-25 10:10:00'), (2, 'user', 'Cảm ơn!', '2025-11-25 10:12:00'), (2, 'bot', 'Không có gì! Chúc bạn ngon miệng.', '2025-11-25 10:15:00'),   (3, 'user', 'Tôi muốn biết nguồn gốc rau củ và thịt.', NOW()), (3, 'bot', 'Tất cả nguyên liệu đều từ các trang trại hữu cơ vùng miền, đảm bảo sạch và tươi ngon.', NOW()),   (4, 'user', 'Tôi muốn đặt 2 phần cơm gà vùng Bắc.', '2025-11-20 14:35:00'), (4, 'bot', 'Cơm gà vùng Bắc hiện còn sẵn. Bạn muốn giao lúc mấy giờ?', '2025-11-20 14:40:00'), (4, 'user', 'Giao lúc 18h hôm nay.', '2025-11-20 14:45:00'), (4, 'bot', 'Đơn hàng của bạn đã được xác nhận và sẽ giao đúng giờ.', '2025-11-20 14:50:00');